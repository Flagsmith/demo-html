<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/flagsmith/index.js"></script>
    <meta charset="utf-8" />
    <title>Flagsmith Store</title>
</head>

<body>
    <h1>Welcome to the Flagsmith Store</h1>
    <h2><a href="step1.html">Step 1 - Look Ma - No Flags</a></h2>
    <h2><a href="step2.html">Step 2 - Testing a New Checkout Flow</a></h2>
    <h2><a href="step3.html">Step 3 - Per User Feature Management</a></h2>
    <h2><a href="step4.html">Step 4 - Gen X's get the new Checkout</a></h2>
</body>

<script>
    function getFlags() {
        flagsmith.init({
            environmentID: 'NowEDzKzNJXZVTVanLVdMQ',
            onChange: (oldFlags, params) => {
                console.log("Grabbing Flags");
                console.log("checkout-v2=" + flagsmith.hasFeature('checkout-v2'));

                if (flagsmith.hasFeature('checkout-v2')) {
                    document.getElementById("checkout-button").href = "checkout/v2.html";
                } else {
                    document.getElementById("checkout-button").href = "checkout/v1.html";
                }
            },
        });
    }

    function login() {
        username = document.getElementById('username').value;

        loggedInDev = document.getElementById("logged-in");
        loggedInDev.innerHTML = 'Logged in as: <b>' + username + '</b>';

        flagsmith.identify(document.getElementById('username').value);
        flagsmith.setTrait("age", 46);
        console.log("Logged in");
    }

    document.getElementById("login-button").addEventListener("click", login);

    getFlags();
</script>

</html>